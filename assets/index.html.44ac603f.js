import{_ as i,r as o,o as r,c as l,a as e,b as n,F as d,d as t,e as a}from"./app.8b2fc08a.js";const c={},h=e("h1",{id:"setup",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#setup","aria-hidden":"true"},"#"),t(" Setup")],-1),p=e("h2",{id:"git-source-code",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#git-source-code","aria-hidden":"true"},"#"),t(" Git & Source Code")],-1),_={href:"https://git-scm.com/",target:"_blank",rel:"noopener noreferrer"},u=t("Git"),g=t(" is a free and open source distributed version control system."),f=a(`<p>The easiest way to get Kibanalytics source code is by installing Git and running the following command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/kibanalytics/kibanalytics.git
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>To start Kibanalytics, it&#39;s mandatory to provide some basic configuration files.</p><h2 id="environment-variables" tabindex="-1"><a class="header-anchor" href="#environment-variables" aria-hidden="true">#</a> Environment Variables</h2><p>Kibanalytics will look for a .env file at the root of the project folder to apply settings to the server.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Use .env.example as base for your environment variables setup. If you just want start straightaway, just rename .env.example to .env and use all default values.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> .env.example .env
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></div><table><thead><tr><th style="text-align:left;">Variable</th><th style="text-align:center;">Type</th><th style="text-align:right;">Allowed Values</th></tr></thead><tbody><tr><td style="text-align:left;">NODE_ENV</td><td style="text-align:center;">string</td><td style="text-align:right;">&#39;development&#39;, &#39;production&#39;</td></tr><tr><td style="text-align:left;">NODE_CLUSTER</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">NODE_LISTEN</td><td style="text-align:center;">string</td><td style="text-align:right;">Valid host IP and port number</td></tr><tr><td style="text-align:left;">EXPRESS_HELMET</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">EXPRESS_GZIP</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">EXPRESS_CORS</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">EXPRESS_ALLOWED_ORIGINS</td><td style="text-align:center;">[string]</td><td style="text-align:right;">Any valid RegExp</td></tr><tr><td style="text-align:left;">EXPRESS_SESSION_NAME</td><td style="text-align:center;">string</td><td style="text-align:right;">Any string</td></tr><tr><td style="text-align:left;">EXPRESS_SESSION_SECRET</td><td style="text-align:center;">string</td><td style="text-align:right;">Any string</td></tr><tr><td style="text-align:left;">EXPRESS_SESSION_COOKIE_MAX_AGE</td><td style="text-align:center;">int</td><td style="text-align:right;">Number &gt;= 0</td></tr><tr><td style="text-align:left;">EXPRESS_SESSION_COOKIE_SAME_SITE</td><td style="text-align:center;">string</td><td style="text-align:right;">&#39;0&#39;, &#39;1&#39;, lax&#39;, &#39;none&#39; or &#39;strict&#39;</td></tr><tr><td style="text-align:left;">EXPRESS_SESSION_COOKIE_SECURE</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">EXPRESS_SESSION_DURATION</td><td style="text-align:center;">int</td><td style="text-align:right;">Number &gt;= 0</td></tr><tr><td style="text-align:left;">EXPRESS_VALIDATE_JSON_SCHEMA</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">EXPRESS_PUBLIC_FOLDER</td><td style="text-align:center;">int</td><td style="text-align:right;">0, 1</td></tr><tr><td style="text-align:left;">SENTRY_DSN</td><td style="text-align:center;">string</td><td style="text-align:right;">Valid Sentry DSN URL</td></tr><tr><td style="text-align:left;">LOGSTASH_REDIS_HOST</td><td style="text-align:center;">string</td><td style="text-align:right;">Valid Redis host</td></tr><tr><td style="text-align:left;">LOGSTASH_REDIS_PORT</td><td style="text-align:center;">int</td><td style="text-align:right;">Valid Redis host port number</td></tr><tr><td style="text-align:left;">REDIS_QUEUE_SERVER_URI</td><td style="text-align:center;">string</td><td style="text-align:right;">Valid Redis URI</td></tr><tr><td style="text-align:left;">REDIS_SESSION_SERVER_URI</td><td style="text-align:center;">string</td><td style="text-align:right;">Valid Redis URI</td></tr><tr><td style="text-align:left;">ELASTICSEARCH_URI</td><td style="text-align:center;">string</td><td style="text-align:right;">Valid Elasticsearch URI</td></tr><tr><td style="text-align:left;">DOCKER_LOG_MAX_SIZE</td><td style="text-align:center;">string</td><td style="text-align:right;">Number &gt;= 1 suffixed with magnitude</td></tr><tr><td style="text-align:left;">DOCKER_LOG_MAX_FILE</td><td style="text-align:center;">int</td><td style="text-align:right;">Number &gt;= 1</td></tr></tbody></table><h3 id="node-env" tabindex="-1"><a class="header-anchor" href="#node-env" aria-hidden="true">#</a> NODE_ENV</h3><p>Flag which indicates whether the server is running on development or production mode.</p><p>If you&#39;re running Node.js outside of docker enviroment, set the value of NODE_ENV to &quot;development&quot;.</p><h3 id="node-cluster" tabindex="-1"><a class="header-anchor" href="#node-cluster" aria-hidden="true">#</a> NODE_CLUSTER</h3>`,11),m=t("Flag to enable or disable Node.js "),b={href:"https://nodejs.org/api/cluster.html",target:"_blank",rel:"noopener noreferrer"},S=t("clustering"),x=t("."),E=e("p",null,"This can drastically improve the performance on multicore deployments by starting one process for each core and distributing the load of requests to the web server.",-1),y=e("h3",{id:"node-listen",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#node-listen","aria-hidden":"true"},"#"),t(" NODE_LISTEN")],-1),v=e("p",null,"Expose Node Docker service host ip and port number for connections.",-1),R=e("h3",{id:"express-helmet",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#express-helmet","aria-hidden":"true"},"#"),t(" EXPRESS_HELMET")],-1),k=e("p",null,"Define several security HTTP response headers to secure the web server.",-1),I=t("Uses "),O={href:"https://github.com/helmetjs/helmet",target:"_blank",rel:"noopener noreferrer"},w=t("Helmet"),T=t(" library for Express web servers."),N=e("p",null,"If the Kibanalytics web server will be used in conjunction with a reverse proxy server, is recomended to disable Helmet and set all security HTTP headers directly on the proxy.",-1),C=e("h3",{id:"express-gzip",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#express-gzip","aria-hidden":"true"},"#"),t(" EXPRESS_GZIP")],-1),D=e("p",null,"Flag to enable or disable HTTP response compress.",-1),A=e("p",null,"If the Kibanalytics web server will be used in conjunction with a reverse proxy server, is recomended to disable Kibanalytics compression and let the reverse proxy take care of it.",-1),L=e("h3",{id:"express-cors",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#express-cors","aria-hidden":"true"},"#"),t(" EXPRESS_CORS")],-1),P=t("Flag to enable or disable "),U={href:"https://developer.mozilla.org/pt-BR/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"},X=t("CORS"),K=t(". Used with EXPRESS_ALLOWED_ORIGINS environment variable."),V=a('<h3 id="express-allowed-origins" tabindex="-1"><a class="header-anchor" href="#express-allowed-origins" aria-hidden="true">#</a> EXPRESS_ALLOWED_ORIGINS</h3><p>Comma separated RegExp values of allowed origins (for example .*virail.[a-z..]+) for CORS. Used with EXPRESS_CORS environment variable.</p><h3 id="express-session-name" tabindex="-1"><a class="header-anchor" href="#express-session-name" aria-hidden="true">#</a> EXPRESS_SESSION_NAME</h3><p>The name of the session cookie to set in the response (and read from in the request).</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>If you have multiple apps running on the same hostname then you need to use distinct session cookies from each one. The simplest way is to set different name session names per app.</p></div><h3 id="express-session-secret" tabindex="-1"><a class="header-anchor" href="#express-session-secret" aria-hidden="true">#</a> EXPRESS_SESSION_SECRET</h3><p>This is the secret used to sign the session cookie. Using a secret that cannot be guessed will reduce the ability to hijack a session by guessing the session name.</p><p>Changing the secret value will invalidate all existing sessions.</p><h3 id="express-session-cookie-max-age" tabindex="-1"><a class="header-anchor" href="#express-session-cookie-max-age" aria-hidden="true">#</a> EXPRESS_SESSION_COOKIE_MAX_AGE</h3><p>Specifies the number (in milliseconds) to use when calculating the Expires Set-Cookie attribute. This is done by taking the current server time and adding maxAge milliseconds to the value to calculate an Expires datetime. By default, 7776000000 (90d) is set.</p><h3 id="express-session-cookie-same-site" tabindex="-1"><a class="header-anchor" href="#express-session-cookie-same-site" aria-hidden="true">#</a> EXPRESS_SESSION_COOKIE_SAME_SITE</h3><p>Specifies the boolean or string to be the value for the SameSite Set-Cookie attribute. By default, this is &#39;1&#39;.</p><p>&#39;1&#39; will set the SameSite attribute to Strict for strict same site enforcement.</p><p>&#39;0&#39; will not set the SameSite attribute.</p><p>&#39;lax&#39; will set the SameSite attribute to Lax for lax same site enforcement.</p><p>&#39;none&#39; will set the SameSite attribute to None for an explicit cross-site cookie.</p><p>&#39;strict&#39; will set the SameSite attribute to Strict for strict same site enforcement.</p><h3 id="express-session-cookie-secure" tabindex="-1"><a class="header-anchor" href="#express-session-cookie-secure" aria-hidden="true">#</a> EXPRESS_SESSION_COOKIE_SECURE</h3><p>Specifies the boolean value for the Secure Set-Cookie attribute. When &#39;1&#39;, the Secure attribute is set, otherwise it is not. By default, the Secure attribute is &#39;0&#39;.</p><h3 id="express-session-duration" tabindex="-1"><a class="header-anchor" href="#express-session-duration" aria-hidden="true">#</a> EXPRESS_SESSION_DURATION</h3><p>Session duration is defined as the time frame during which there are regular active interactions occurring between a user. The session is timed out when there is no activity from the user for a predefined time duration of 1800000ms (30 minutes by default).</p><h3 id="express-validate-json-schema" tabindex="-1"><a class="header-anchor" href="#express-validate-json-schema" aria-hidden="true">#</a> EXPRESS_VALIDATE_JSON_SCHEMA</h3><p>Enable custom event payload validation.</p><h3 id="express-public-folder" tabindex="-1"><a class="header-anchor" href="#express-public-folder" aria-hidden="true">#</a> EXPRESS_PUBLIC_FOLDER</h3><p>Serve the public folder on the web server. Used to for development &amp; testing.</p><h3 id="sentry-dsn" tabindex="-1"><a class="header-anchor" href="#sentry-dsn" aria-hidden="true">#</a> SENTRY_DSN</h3>',26),H=t("Enable "),G={href:"https://sentry.io",target:"_blank",rel:"noopener noreferrer"},q=t("Sentry"),F=t(" performance and error tracking."),j=a('<p>Disable with empty value.</p><h3 id="logstash-redis-host" tabindex="-1"><a class="header-anchor" href="#logstash-redis-host" aria-hidden="true">#</a> LOGSTASH_REDIS_HOST</h3><p>Redis queue server hostname.</p><h3 id="logstash-redis-port" tabindex="-1"><a class="header-anchor" href="#logstash-redis-port" aria-hidden="true">#</a> LOGSTASH_REDIS_PORT</h3><p>Redis queue server port.</p><h3 id="redis-queue-server-uri" tabindex="-1"><a class="header-anchor" href="#redis-queue-server-uri" aria-hidden="true">#</a> REDIS_QUEUE_SERVER_URI</h3><p>Redis queue server connection URI. Needs to use the same values from LOGSTASH_REDIS_HOST and LOGSTASH_REDIS_PORT variables. This is necessary because some services needs to use hostname / port and others only accept URI connection string.</p><h3 id="redis-session-server-uri" tabindex="-1"><a class="header-anchor" href="#redis-session-server-uri" aria-hidden="true">#</a> REDIS_SESSION_SERVER_URI</h3><p>Redis session server connection URI.</p><h3 id="elasticsearch-uri" tabindex="-1"><a class="header-anchor" href="#elasticsearch-uri" aria-hidden="true">#</a> ELASTICSEARCH_URI</h3>',10),M={href:"https://www.elastic.co",target:"_blank",rel:"noopener noreferrer"},B=t("Elasticsearch"),z=t(" server connection URI."),W=a('<p>To point to the local Elasticsearch server started with Docker Compose, use the value &quot;http://elasticsearch:9200&quot; as it is an alias to the internal Docker network Elasticsearch host.</p><p>If NODE_ENV is set to &quot;development&quot;, Node.js server will override ELASTICSEARCH_URI value to &quot;http://localhost:9200&quot;.</p><h3 id="docker-log-max-size" tabindex="-1"><a class="header-anchor" href="#docker-log-max-size" aria-hidden="true">#</a> DOCKER_LOG_MAX_SIZE</h3><p>Docker log file max size.</p><h3 id="docker-log-max-file" tabindex="-1"><a class="header-anchor" href="#docker-log-max-file" aria-hidden="true">#</a> DOCKER_LOG_MAX_FILE</h3><p>Docker log files max count.</p><h2 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a> Docker-Compose</h2>',7),Z={href:"https://docs.docker.com/compose/",target:"_blank",rel:"noopener noreferrer"},J=t("Docker-Compose"),Q=t(" is a tool that helps to define and share multi-container applications. As Kibanalytics is composed by a stack of open source projects, it's easier for a quick start to use containers."),Y=e("p",null,"It's necessary to install Docker and Docker-Compose to the host where Kibanalytics will run.",-1),$={href:"https://docs.docker.com/engine/install/",target:"_blank",rel:"noopener noreferrer"},ee=t("Docker instalation setup"),te={href:"https://docs.docker.com/compose/install/",target:"_blank",rel:"noopener noreferrer"},se=t("Docker-Compose instalation setup"),ne=a(`<p>After completing all the setup steps from Docker and Docker-Compose, to start Kibanalytics using the default configuration, run the following commands:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> kibanalytics
<span class="token function">cp</span> .env.example .env
<span class="token function">cp</span> -r .config.example .config
<span class="token function">docker-compose</span> --profile <span class="token builtin class-name">local</span> --profile production up --build
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,2),ae=t("If you're starting Kibanalytics for the first time, it's necessary to "),ie={href:"https://www.elastic.co/guide/en/kibana/7.17/index-patterns.html",target:"_blank",rel:"noopener noreferrer"},oe=t("create a Kibana index pattern"),re=t(" to be able to visualize the collected data."),le=a(`<p>To make this process easier, we provide a script to automate this process and also load the default dashboards. To run the script, execute the following command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> run <span class="token function">node</span> <span class="token function">npm</span> run load-dashboards
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,2),de=t("After all containers started, you can open Kibana to check events and metrics by accessing "),ce={href:"http://localhost:5601/app/dashboards",target:"_blank",rel:"noopener noreferrer"},he=t("http://localhost:5601/app/dashboards"),pe=t("."),_e=e("div",{class:"custom-container tip"},[e("p",{class:"custom-container-title"},"TIP"),e("p",null,"Kibana server take some minutes to boot, so don't panic if you try to access the Kibana URL and nothing shows up.")],-1),ue=t("If you started Kibanalytics with NODE_ENV=development and EXPRESS_PORT=3000, you can also access "),ge={href:"http://localhost:3000/",target:"_blank",rel:"noopener noreferrer"},fe=t("http://localhost:3000/"),me=t(" to interact with some example pages to generate events."),be=e("h2",{id:"advanced-configurations",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#advanced-configurations","aria-hidden":"true"},"#"),t(" Advanced Configurations")],-1),Se=e("p",null,`It's possible to provide some aditional advanced configurations to Kibanalytics engine gears by editing the corresponding files in "/.config" folder.`,-1),xe=e("h3",{id:"redis",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#redis","aria-hidden":"true"},"#"),t(" Redis")],-1),Ee=t('To provide aditional settings to the local Redis instance, edit ".config/redis/redis.conf" file. For more information about the available setting options, please check '),ye={href:"https://redis.io/docs/manual/config/",target:"_blank",rel:"noopener noreferrer"},ve=t("Redis configuration"),Re=t(" docs."),ke=e("h3",{id:"twemproxy",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#twemproxy","aria-hidden":"true"},"#"),t(" Twemproxy")],-1),Ie=t('To provide aditional settings to the local Twemproxy instance, edit ".config/twemproxy/twemproxy.yml" file. For more information about the available setting options, please check '),Oe={href:"https://github.com/twitter/twemproxy",target:"_blank",rel:"noopener noreferrer"},we=t("Twemproxy Configuration"),Te=t(" docs."),Ne=e("h3",{id:"logstash",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#logstash","aria-hidden":"true"},"#"),t(" Logstash")],-1),Ce=t('To provide aditional settings to the local Logstash instance, edit ".config/logstash/logstash.yml" file. For more information about the available setting options, please check '),De={href:"https://www.elastic.co/guide/en/logstash/current/logstash-settings-file.html",target:"_blank",rel:"noopener noreferrer"},Ae=t("Logstash Configuration"),Le=t(" docs."),Pe=t(`Also, it's possible to edit que main Logstash pipeline by editing ".config/logstash/pipeline/tracker.conf" file. For more information about pipeline settings, please check `),Ue={href:"https://www.elastic.co/guide/en/logstash/current/configuration.html",target:"_blank",rel:"noopener noreferrer"},Xe=t("Configuring Logstash"),Ke=t(" docs."),Ve=e("h3",{id:"kibana",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#kibana","aria-hidden":"true"},"#"),t(" Kibana")],-1),He=t('To provide aditional settings to the local Kibana instance, edit ".config/kibana/kibana.yml" file. For more information about the available setting options, please check '),Ge={href:"https://www.elastic.co/guide/en/kibana/current/settings.html",target:"_blank",rel:"noopener noreferrer"},qe=t("Configure Kibana"),Fe=t(" docs.");function je(Me,Be){const s=o("ExternalLinkIcon");return r(),l(d,null,[h,p,e("p",null,[e("a",_,[u,n(s)]),g]),f,e("p",null,[m,e("a",b,[S,n(s)]),x]),E,y,v,R,k,e("p",null,[I,e("a",O,[w,n(s)]),T]),N,C,D,A,L,e("p",null,[P,e("a",U,[X,n(s)]),K]),V,e("p",null,[H,e("a",G,[q,n(s)]),F]),j,e("p",null,[e("a",M,[B,n(s)]),z]),W,e("p",null,[e("a",Z,[J,n(s)]),Q]),Y,e("p",null,[e("a",$,[ee,n(s)])]),e("p",null,[e("a",te,[se,n(s)])]),ne,e("p",null,[ae,e("a",ie,[oe,n(s)]),re]),le,e("p",null,[de,e("a",ce,[he,n(s)]),pe]),_e,e("p",null,[ue,e("a",ge,[fe,n(s)]),me]),be,Se,xe,e("p",null,[Ee,e("a",ye,[ve,n(s)]),Re]),ke,e("p",null,[Ie,e("a",Oe,[we,n(s)]),Te]),Ne,e("p",null,[Ce,e("a",De,[Ae,n(s)]),Le]),e("p",null,[Pe,e("a",Ue,[Xe,n(s)]),Ke]),Ve,e("p",null,[He,e("a",Ge,[qe,n(s)]),Fe])],64)}var We=i(c,[["render",je],["__file","/Users/ibrahimnetto/GitHub/kibanalytics/docs/.vuepress/.temp/pages/setup/index.html.vue"]]);export{We as default};
